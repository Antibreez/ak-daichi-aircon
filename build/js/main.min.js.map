{"version":3,"sources":["code-ragistration.js"],"names":["emailValidation","hasPurchaseDateError","hasWarrantyCodeError","hasWarrantyEmailError","hasWarrantyCityError","warrantyCodeMask","$","attr","replace","inputmask","mask","showMaskOnHover","isPurchaseDateValid","date","val","split","filter","w","length","Date","parse","isWarrantyCodeValid","trim","RegExp","test","includes","isWarrantyEmailValid","isWarrantyCityValid","onPurchaseDateSelect","parent","removeClass","removeAttr","datepickerMonths","datepicker","regional","closeText","prevText","nextText","currentText","monthNames","monthNamesShort","dayNames","dayNamesShort","dayNamesMin","weekHeader","dateFormat","firstDay","isRTL","showMonthAfterYear","yearSuffix","changeMonth","changeYear","yearRange","getFullYear","minDate","maxDate","showOtherMonths","onSelect","onChangeMonthYear","console","log","find","setTimeout","each","idx","e","select2","minimumResultsForSearch","Infinity","dropdownCssClass","setDefaults","on","document","preventDefault","warrantyCodeStage","valid","addClass","submit","this","hasClass","remove","$popup","clone","append","onWarrantyCodePopupClose"],"mappings":"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","file":"main.min.js","sourcesContent":["const emailValidation = /^([\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4})?$/\n\n// const $warrantyCodeForm = $('.code-registration__form')\n// const $('.code-registration__form #warranty-code') = $warrantyCodeForm.find('#warranty-code')\n// const $('.code-registration__form #purchase-date') = $warrantyCodeForm.find('#purchase-date')\n// const $('.code-registration__form #email') = $warrantyCodeForm.find('#email')\n// const $('.code-registration__form #city') = $warrantyCodeForm.find('#city')\n// const $('.code-registration__form .code-registration__note') = $warrantyCodeForm.find('.code-registration__note')\n// // const $('.code-registration__form button[type=\"submit\"]') = $warrantyCodeForm.find('button[type=\"submit\"]')\n\n// const warrantyCodeStage = $('.code-registration__form #warranty-code').length ? 1 : $('.code-registration__form #email').length ? 2 : 3\n\nlet hasPurchaseDateError = false\nlet hasWarrantyCodeError = false\nlet hasWarrantyEmailError = false\nlet hasWarrantyCityError = false\n\nconst warrantyCodeMask = $('.code-registration__form #warranty-code').attr('placeholder')\n  ? $('.code-registration__form #warranty-code').attr('placeholder').replace(/_/g, 9)\n  : '99999-99999-99999'\n\n$('.code-registration__form #warranty-code').inputmask({\n  mask: warrantyCodeMask,\n  showMaskOnHover: false,\n})\n\nconst isPurchaseDateValid = () => {\n  const date = $('.code-registration__form #purchase-date').val()\n\n  return (\n    $('.code-registration__form #purchase-date')\n      .val()\n      .split('')\n      .filter(w => w === '.').length === 2 &&\n    !!Date.parse(`${date.split('.')[1]}/${date.split('.')[0]}/${date.split('.')[2]}`)\n  )\n}\n\nconst isWarrantyCodeValid = () => {\n  if ($('.code-registration__form #warranty-code').attr('pattern')) {\n    return (\n      $('.code-registration__form #warranty-code').val().trim() &&\n      new RegExp($('.code-registration__form #warranty-code').attr('pattern')).test(\n        $('.code-registration__form #warranty-code').val()\n      )\n    )\n  }\n\n  return (\n    $('.code-registration__form #warranty-code').val().trim() &&\n    !$('.code-registration__form #warranty-code').val().includes('_')\n  )\n}\n\nconst isWarrantyEmailValid = () => {\n  if (\n    $('.code-registration__form #email').val().trim() &&\n    new RegExp(emailValidation).test($('.code-registration__form #email').val())\n  ) {\n    return true\n  }\n\n  return false\n}\n\nconst isWarrantyCityValid = () => {\n  return !!$('.code-registration__form #city').val().trim()\n}\n\ndatepickerMonths = [\n  'Январь',\n  'Февраль',\n  'Март',\n  'Апрель',\n  'Май',\n  'Июнь',\n  'Июль',\n  'Август',\n  'Сентябрь',\n  'Октябрь',\n  'Ноябрь',\n  'Декабрь',\n]\n\n$.datepicker.regional['ru'] = {\n  closeText: 'Закрыть',\n  prevText: 'Предыдущий',\n  nextText: 'Следующий',\n  currentText: 'Сегодня',\n  monthNames: datepickerMonths,\n  monthNamesShort: datepickerMonths,\n  dayNames: ['воскресенье', 'понедельник', 'вторник', 'среда', 'четверг', 'пятница', 'суббота'],\n  dayNamesShort: ['вск', 'пнд', 'втр', 'срд', 'чтв', 'птн', 'сбт'],\n  dayNamesMin: ['Вс', 'Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб'],\n  weekHeader: 'Не',\n  dateFormat: 'dd.mm.yy',\n  firstDay: 1,\n  isRTL: false,\n  showMonthAfterYear: false,\n  yearSuffix: '',\n  changeMonth: true,\n  changeYear: true,\n  yearRange: `1990:${new Date().getFullYear()}`,\n  minDate: new Date(1990, 0, 1),\n  maxDate: new Date(),\n  showOtherMonths: true,\n  onSelect: onPurchaseDateSelect,\n  onChangeMonthYear: function () {\n    console.log('###el', $('#ui-datepicker-div').find('select'))\n    setTimeout(() => {\n      $('#ui-datepicker-div')\n        .find('select')\n        .each((idx, e) => {\n          $(e).select2({\n            minimumResultsForSearch: Infinity,\n            dropdownCssClass: 'datepicker-dropdown',\n          })\n        })\n    }, 100)\n  },\n}\n\n$.datepicker.setDefaults($.datepicker.regional['ru'])\n\n$('#purchase-date').datepicker()\n\n$('#purchase-date').on('click', function () {\n  const el = $('#ui-datepicker-div').find('select')\n\n  el.each((idx, e) => {\n    $(e).select2({\n      minimumResultsForSearch: Infinity,\n      dropdownCssClass: 'datepicker-dropdown',\n    })\n  })\n})\n\nfunction onPurchaseDateSelect() {\n  hasPurchaseDateError = false\n  $('.code-registration__form #purchase-date').parent().removeClass('is--invalid')\n\n  if (!hasWarrantyCodeError && !hasPurchaseDateError)\n    $('.code-registration__form button[type=\"submit\"]').removeAttr('disabled')\n}\n\n$('.code-registration__form #warranty-code').on('input', function (e) {\n  hasWarrantyCodeError = false\n  $('.code-registration__form #warranty-code').parent().removeClass('is--invalid')\n\n  if (!hasWarrantyCodeError && !hasPurchaseDateError)\n    $('.code-registration__form button[type=\"submit\"]').removeAttr('disabled')\n})\n\n$('.code-registration__form #purchase-date').on('input', function (e) {\n  hasPurchaseDateError = false\n  $('.code-registration__form #purchase-date').parent().removeClass('is--invalid')\n\n  if (!hasWarrantyCodeError && !hasPurchaseDateError)\n    $('.code-registration__form button[type=\"submit\"]').removeAttr('disabled')\n})\n\n$(document).on('input', '.code-registration__form #email', function () {\n  hasWarrantyEmailError = false\n  $('.code-registration__form #email').parent().removeClass('is--invalid')\n\n  if (!hasWarrantyEmailError && !hasWarrantyCityError)\n    $('.code-registration__form button[type=\"submit\"]').removeAttr('disabled')\n})\n\n$(document).on('input', '.code-registration__form #city', function () {\n  hasWarrantyCityError = false\n  $('.code-registration__form #city').parent().removeClass('is--invalid')\n\n  if (!hasWarrantyEmailError && !hasWarrantyCityError)\n    $('.code-registration__form button[type=\"submit\"]').removeAttr('disabled')\n})\n\n$(document).on('click', '.code-registration__form button[type=\"submit\"]', function (e) {\n  e.preventDefault()\n\n  const warrantyCodeStage = $('.code-registration__form #warranty-code').length\n    ? 1\n    : $('.code-registration__form #email').length\n    ? 2\n    : 3\n\n  if (warrantyCodeStage === 1) {\n    let valid = true\n\n    if (!isWarrantyCodeValid()) {\n      hasWarrantyCodeError = true\n      $('.code-registration__form #warranty-code').parent().addClass('is--invalid')\n      valid = false\n    }\n\n    if (!isPurchaseDateValid()) {\n      hasPurchaseDateError = true\n      $('.code-registration__form #purchase-date').parent().addClass('is--invalid')\n      valid = false\n    }\n\n    console.log('valid', valid)\n\n    if (valid) {\n      $('.code-registration__form').find('form').submit()\n    } else {\n      $('.code-registration__form button[type=\"submit\"]').attr('disabled', true)\n    }\n  }\n\n  if (warrantyCodeStage === 2) {\n    let valid = true\n\n    if (!isWarrantyEmailValid()) {\n      hasWarrantyEmailError = true\n      $('.code-registration__form #email').parent().addClass('is--invalid')\n      valid = false\n    }\n\n    if (!isWarrantyCityValid()) {\n      hasWarrantyCityError = true\n      $('.code-registration__form #city').parent().addClass('is--invalid')\n      valid = false\n    }\n\n    if (valid) {\n      $('.code-registration__form').find('form').submit()\n    } else {\n      $('.code-registration__form button[type=\"submit\"]').attr('disabled', true)\n    }\n  }\n})\n\n$(document).on('click', '.code-registration__form .code-registration__note', function () {\n  if (!$(this).hasClass('is--opened')) {\n    $(this).addClass('is--opened')\n\n    const $popup = $('.code-registration__form .code-registration__note').find('.code-registration__code-popup').clone()\n    $popup.addClass('code-registration__code-popup--outer')\n\n    $('body').append($popup)\n    $popup.addClass('is--visible')\n  } else {\n    $(this).removeClass('is--opened')\n\n    $('.code-registration__code-popup--outer').remove()\n  }\n})\n\nconst onWarrantyCodePopupClose = () => {\n  $('.code-registration__form .code-registration__note').removeClass('is--opened')\n  $('.code-registration__code-popup--outer').remove()\n}\n\n$(document).on(\n  'click',\n  '.code-registration__code-popup--outer .code-registration__code-popup-bg',\n  onWarrantyCodePopupClose\n)\n$(document).on(\n  'click',\n  '.code-registration__code-popup--outer .code-registration__code-popup-close',\n  onWarrantyCodePopupClose\n)\n"]}